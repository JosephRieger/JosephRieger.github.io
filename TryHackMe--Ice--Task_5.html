<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 5</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Task 5</h1><br/><strong><h1>Learn how to gather additional credentials and crack the saved hashes on the machine.</h1></strong><br /><br /><br /><strong>Prior to further action, we need to move to a process that actually has the permissions that we need to interact with the lsass service, the service responsible for authentication within Windows. First, let's list the processes using the command `ps`. Note, we can see processes being run by NT AUTHORITY\SYSTEM as we have escalated permissions (even though our process doesn't).<br /><br /><br /><br />                                                                                        <br /> In order to interact with lsass we  need to be 'living in' a process that is the same architecture as the  lsass service (x64 in the case of this machine) and a process that has  the same permissions as lsass. The printer spool service happens to meet  our needs perfectly for this and it'll restart if we crash it! What's  the name of the printer service?<br />Mentioned within this question is  the term 'living in' a process. Often when we take over a running  program we ultimately load another shared library into the program (a  dll) which includes our malicious code. From this, we can spawn a new  thread that hosts our shell. <br /><br /></strong>• spoolsv.exe<strong><br />                        <br /><br />Migrate to this process now with the command `migrate -N PROCESS_NAME`       <br /><br /><br />Let's check what user we are now with the command `getuid`. What user is listed? <br />   •  </strong>NT AUTHORITY\SYSTEM<strong><br /><br /><br /><br />Now that we've made our way to full administrator permissions we'll set our sights on looting. Mimikatz is a rather infamous password dumping tool that is incredibly useful. Load it now using the command `load kiwi` (Kiwi is the updated version of Mimikatz)       <br /><br /><br />Loading kiwi into our meterpreter session will expand our help menu, take a look at the newly added section of the help menu now via the command `help`.   <br /><br /><br />Which command allows up to retrieve all credentials?   <br />• creds_all<br /><br /><br />                                                                                        <br /> Run this command now. What is Dark's password? Mimikatz  allows us to steal this password out of memory even without the user  'Dark' logged in as there is a scheduled task that runs the Icecast as  the user 'Dark'. It also helps that Windows Defender isn't running on  the box ;) (Take a look again at the ps list, this box isn't in the best  shape with both the firewall and defender disabled)</strong><br />                            <br />•Password01! <br />    </div></body></html>