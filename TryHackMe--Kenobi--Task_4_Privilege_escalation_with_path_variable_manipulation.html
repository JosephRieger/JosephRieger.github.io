<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 4 Privilege escalation with path variable manipulation</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Task 4 Privilege escalation with path variable manipulation</h1><br/>                                                                                        <br /> SUID bits can be dangerous, some  binaries such as passwd need to be run with elevated privileges (as its  resetting your password on the system), however other custom files could  that have the SUID bit can lead to all sorts of issues.<br /> <br />To search the a system for these type of files run the following: <span style="color:#ce0000;">find / -perm -u=s -type f 2&gt;/dev/null</span><br /><br /><strong>What file looks particularly out of the ordinary?</strong> <br /><br />    <strong>Answer</strong>: /usr/bin/menu  <br />                        <br /> <br /><strong>Run the binary, how many options appear?</strong><br /><br />    <strong>Answer: </strong>3  <br />                                               <br /><br />Strings is a command on Linux that looks for human readable strings on a binary.<br />• running string /usr/bin/menu reveals that the first option “status check” calls curl -I localhost<br /><br />This shows us the binary is running without a full path (e.g. not using /usr/bin/curl or /usr/bin/uname).<br />As this file runs as the root users privileges, we can manipulate our path gain a root shell.<br /><br /><img src="images/60-1.png" alt="images/60-1.png" /><br />We  copied the /bin/sh shell, called it curl, gave it the correct  permissions and then put its location in our path. This meant that when  the /usr/bin/menu binary was run, its using our path variable to find  the "curl" binary.. Which is actually a version of /usr/sh, as well as  this file being run as root it runs our shell as root!<br />                            <br />                        <br /><br /><strong>What is the root flag (/root/root.txt)?</strong><br /><br />    <strong>Answer: </strong>177b3cd8562289f37382721c28381f02<br />                            <br />                        <br />                                                                        <br /><br /></div></body></html>