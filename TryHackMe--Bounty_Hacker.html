<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Bounty Hacker</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Bounty Hacker</h1><br/><br /><h2>Summary</h2>:<br /><br />In this challenge we are presented with a machine that runs a webserver as well as an FTP server. The FTP server is not properly secured an allows users to log in anonymously without requiring any form of authentication.<br />This grants the user access to a list of passwords, which can be used to brute force the SSH login credentials for the user ‘lin’. Once connected, it is possible to escalate the user's privileges by manipulating /etc/update-motd.d/00-header. This is possible due to improperly set permissions. This file is owned by root, however ‘lin’ is able to write to it. After manipulating this file, we only need to logout and log back in to be granted root<br />privileges since this file is executed every time a user logs in via SSH.<br /><br /><br /><br /><strong>Find open ports on the machine</strong><br /><br />    <code>sudo nmap -A &lt;IP&gt;</code><br />    <br />    This reveals that port 21 (FTP),  22 (SSH) and 80 (HTTP) are open<br /><br /><br /><br /><strong>Who wrote the task list?</strong><br /><br />    When visiting the server through Firefox we are greeted by an in-universe description of the job.<br />    Scanning for hidden directories with Gobuster only reveals the /images directory, which contains nothing but the image used on the landing page.<br />    <br />    When accessing the FTP server via <code>ftp &lt;IP&gt;</code>  it reveals itself as an anonymous FTP server.<br />    <br />    Logging in with ‘anonymous:’ grants access to two files: task.txt and locks.txt<br />    <br />    Locks.txt seems to contain a long list of passwords.<br />    Tasks.txt contains a list of tasks and it's signed by Lin.<br />    <br />    <br /><strong>    Answer: lin</strong><br /><br /><br /><br /><strong>What service can you bruteforce with the text file found?</strong><br /><br />    That service would be SSH.<br />    <br /><strong>    Answer: SSH</strong><br /><br /><br /><br /><strong>What is the users password? </strong><br /><br />    Since ‘lin’ was the one that created the task list, it's very likely that this is also the username that can be used to connect to the server via SSH.<br />    <br />    Knowing the username it's possible to use Hydra to try all the passwords in the locks.txt file.<br />    <br />    <code>hydra -l lin -P &lt;path&gt;/locks.txt  &lt;IP&gt; -V -T 32 ssh</code><br />    <br />    The password is the following:<br />    <br /><strong>    Answer: RedDr4gonSynd1cat3 </strong><br /><br /><br /><br /><strong>user.txt</strong><br /><br />    Using the password that was obtained to login as lin via SSH, we can find the user.txt file on the desktop.<br /><br />    <br /><strong>    Answer: THM{CR1M3_SyNd1C4T3}</strong><br /><br /><br /><br /><strong>root.txt   </strong> <br /><br />    First we download linpeas.sh on our attack box and use Python to quickly start a server in the same directory. Afterwards ‘wget’ can be used on the victim machine to download that script from our attack box.<br />    <br />    Running it reveals that the /etc/update-motd.d/00-header file is owned by root, but lin can also write to it.<br />    <br />    00-header is a script, which gets executed whenever a remote user connects to the machine. Nomally it just prints some information about the system to the screen.<br />    <br />    However, since lin can write to it, we can append the following line to it:<br />    <br />    <code>cp /bin/bash /home/lin/bash &amp;&amp; chmod u+s /home/lin/bash</code><br />    <br />    This copies the bash binary to lin's home directory and sets the SUID bit. This is possible because, again, 00-header is owned by root.<br />    <br />    After logging out and logging back in a bash binary with the SUID bit set can be found in lin's home directory.<br />    <br />    We can execute it as follows:<br />    <code>./bash -p</code><br />    <br />    The  flag ‘-p’ allows us to execute bash without dropping root privileges.<br />    This gives us root access and allows us to print the content of root.txt in the /root directory.<br />    <br /><strong>    Answer: THM{80UN7Y_h4cK3r}</strong><br /><br /><br />                                                </div></body></html>