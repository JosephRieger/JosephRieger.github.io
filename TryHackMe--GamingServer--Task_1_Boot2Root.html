<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 1 Boot2Root</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">GamingServer</h1><br/><h2>Summary:</h2><br /><br />In this challenge we are presented with an Apache webserver. The webserver serves a hidden directory, which contains a private RSA key as well as a list of passwords. This enables us to log in via SSH. To do so, the password list needs to be used to crack the required passphrase. Once on the system it is revealed that the user is part of the LXC group. LXC is a method to run linux containers. Being in the LXC group allows us to mount the file system in a container. Since we do have root privileges within our own container we also have root privilege access to the machine's file system mounted within said container.<br /><br /><br /><br /><strong>What is the user flag?</strong><br /><br />    Scan with Nmap reveals that Port 22 (SSH) and 80 (HTTP) are open.<br />    They are exposing OpenSSH 7.6p1 and Apache 2.4.29 respectivley.<br /><br /><br />    Visiting the site through the browser does not reveal any useful information initially.<br />    <br />    Enumerating the directories of the webserver using Gobuster:<br />   <code> gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u </code><a href="http://10.10.189.142">http://10.10.189.142</a><br />    revealed two hidden directories: uploads and secret.<br /><br />    The Uploads directory doesn't contain anything of real interest besides a list of common passwords. The secret directory leads to an encrypted private RSA key.<br /><br />    Following this tutorial <a href="https://null-byte.wonderhowto.com/how-to/crack-ssh-private-key-passwords-with-john-ripper-0302810/">https://null-byte.wonderhowto.com/how-to/crack-ssh-private-key-passwords-with-john-ripper-0302810/</a> we can use JohnTheRipper to crack the required passphrase for the RSA key. <br />    The wordlist that was found in the /uploads/ directory of the server was used as the wordlist in the cracking process.<br />    <br />    The passphrase is ‘letmein’<br />    <br />    Using <code>ssh -i secretKey &lt;IP&gt;</code> we can attempt to login using the private key. However, if we do this the session gets closed immediately. As it turns out, the user this key belongs to is ‘john’. This piece of information can be found in a comment left in the HTML source of the homepage.<br />    <br />    After logging in we can see the user.txt file in the home directory of john.<br />    <br /><strong>    Answer: a5c2ff8b9c2e3d4fe9d4ff2f1a5a6e7e</strong><br /><br /><br /><br /><strong>What is the root flag?</strong><br /><br />    After uploading and running the LinEnum.sh script it is revealed that john is a member of the ‘lxc’ group.<br />    This means that we can gain root privileges by mounting the filesystem in a LXC container.<br />    <br />   •  To do this an Alpine Linux image was downloaded from here <a href="https://github.com/lxd-images/alpine-3-7-apache-php5-6">https://github.com/lxd-images/alpine-3-7-apache-php5-6</a> .<br />   • Next the import.sh script that's within the downloaded folder was executed<br />   • Afterwards the image can be exported using <code>lxc image export &lt;fingerprint&gt;</code><br />   •  The container that this creates is then downloaded onto the machine we want to escalate our privileges on<br />   • After a successful download the image can be mounted as follows:<br />      ◇ <code>lxc image import &lt;imagename&gt; --alias &lt;alias&gt;</code><br />      ◇ <code>lxc init &lt;alias&gt; &lt;containername&gt; -c security.privileged= true</code> <br />         ▪ this is done to obtain root privileges within the container<br />      ◇ <code>lxc config device add &lt;containername&gt; &lt;devicename&gt; disk source=/ path=/mnt/root recursive=true</code><br />         ▪ this is done to mount the root directory of the host machine<br />      ◇ <code>lxc start &lt;containername&gt;</code><br />      ◇ <code>lxc exec &lt;containername&gt; /bin/sh</code><br />    <br />    Now we have access to the host machine's files and root privileges.<br />    The host machine's root folder is located in /mnt/root<br />    <br />    To get the root flag we need to navigate to /mnt/root/root/. There we can read the contents of root.txt<br />    <br /><strong>    Answer: 2e337b8c9f3aff0c2b3e8d4e6a7c88fc</strong><br />    </div></body></html>