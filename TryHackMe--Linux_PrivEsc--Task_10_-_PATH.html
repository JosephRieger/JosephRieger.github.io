<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Task 10 - PATH</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">Task 10 - PATH</h1><br/><strong>What is the odd folder you have write access for?</strong><br /><br />    First we execute the following command:<br />        ‘find / -writable 2&gt;/dev/null | cut -d "/" -f 2,3 | grep -v proc | sort -u’<br />    This shows us all the folders that we can write in. The one that sticks out is the home directory of the user ‘murdoch’, because normally users don't have acces to the home directories of other users.<br />    <br />   <strong> Answer: /home/murdoch</strong><br /><br /><br /><strong>Exploit the $PATH vulnerability to read the content of the flag6.txt file.</strong><br /><br />    In the home directory of ‘murdoch’ we find a Python script that executes a binary called ‘thm’.<br />    This script was created by root and has the SUID bit set. We also find a binary called test.<br />    <br />    If we assume that test is an executable version of the Python script we can use it to gain root access. This is because this binary is also owned by root and has its SUID bit set.<br />    <br />    <br /><br /><strong>What is the content of the flag6.txt file?</strong><br />    <br />    First we add the /tmp directory to the PATH:<br />        export PATH=/tmp:$PATH<br />        <br />    Next, we copy the bash binary in there and call it ‘thm’ since this is the name of the program to be executed in the Python script / the test binary.<br />    <br />    ‘cp /bin/bash /tmp/thm’<br />    <br />    Afterwards we have root access and can read the contents of the flag, which is located in matt's home directory.<br />    <br />  <strong>  Answer: THM-736628929   </strong>                                        </div></body></html>